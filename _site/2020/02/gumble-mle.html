<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Maximum Likelihood Estimation of Gumbel Distribution - Manik Kumar</title>
  <meta name="description" content="This is a write up to derive the maximum liklihood solution for estimation of a gumbel distribution.">
  <link href='https://fonts.googleapis.com/css?family=Roboto+Mono|Roboto:300,400,900,400italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/2020/02/gumble-mle.html">
  <link rel="alternate" type="application/rss+xml" title="Manik Kumar" href="http://localhost:4000/feed.xml">
  <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch.png">
  <link href='http://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
</head>

  <body>
    <main class="u-container">
      <div class="c-page">
  <header class="c-page__header">
  
  <h1>Manik ðŸ¤–ðŸ’»
</h1>
  <p>
    <a href="/">Home</a><span
          class="u-separate"></span> <a href="/projects/">Projects</a><span class="u-separate"></span> <a href="/blog.html">Blog</a>
  </p>
</header>

  <div class="c-page__main">
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<article class="c-article">
  <header class="c-article__header">
    <h1 class="c-article__title">Maximum Likelihood Estimation of Gumbel Distribution</h1>
    <p class="c-article__time"><time datetime="2020-02-06T00:00:00-05:00" itemprop="datePublished">Feb 6, 2020</time></p>
  </header>
  <!-- Post Tags -->
  <ul class="c-tags">
    
    <li class="c-tag">Machine-Learning</li>
    
    <li class="c-tag">Estimation</li>
    
  </ul>
  <div class="c-article__main">
    <p>This is a write up to derive the maximum liklihood solution for estimation of a gumbel distribution.</p>

<p>Letâ€™s start with the probability density function of the gumbel distribution, which is</p>

<script type="math/tex; mode=display">p(x)=\frac{1}{\beta}e^{\frac{x-\alpha}{\beta}}e^{-e^{\frac{x-\alpha}{\beta}}}</script>

<script type="math/tex; mode=display">\text{where }\alpha \text{ and } \beta \text{ are parameters and }\alpha \in \mathbb{R}, \beta > 0</script>

<p>Maximum liklihood solution can be written as,</p>

<script type="math/tex; mode=display">\mathrm{f}_{M L}=\underset{\alpha \in \mathbb{R}, \beta>0}{\operatorname{argmax}} \in \mathbb{R}, \beta>0(P(D | \alpha, \beta))</script>

<p>where <em>D</em> represents the set of datapoints.</p>

<script type="math/tex; mode=display">\mathrm{f}_{M L}=\underset{\alpha \in \mathbb{R}, \beta>0}{\operatorname{argmax}} \in \mathbb{R}, \beta>0(\prod_{i=1}^n P(x_i | \alpha, \beta))</script>

<p>where <em>x</em><sub><em>i</em></sub> represents each datapoint.</p>

<p>Now onto calculating the log-likelihood,</p>

<script type="math/tex; mode=display">=\ln \left(\prod_{i=0}^{n} P\left(x_{i} | \alpha, \beta\right)\right)</script>

<script type="math/tex; mode=display">=\sum_{i=0}^{n} \ln P\left(\left(x_{i} | \alpha, \beta\right)\right)</script>

<script type="math/tex; mode=display">=\sum_{i=0}^{n} \ln \left(\frac{1}{\beta} e^{-\frac{y_{i}-\alpha}{\beta}} e^{-e^{-\frac{j_{j}-a}{\beta}}}\right)</script>

<p>We end up with an equation with 2 variables in it, weâ€™ll be using <a href="http://www.sosmath.com/calculus/diff/der07/der07.html">the Newton-Raphson method</a> to approximate the roots of the equation. I recommend reading through the link if youâ€™re familiar with the approximation method.</p>

<p>Finding derivatives, with respect to both <em>Î±</em> and <em>Î²</em>.</p>

<script type="math/tex; mode=display">\frac{\partial f}{\partial \beta}=\sum_{i=0}^{n} \frac{x_{i}-n}{\beta^{2}}-\frac{n}{\beta}-\sum_{i=0}^{n} \frac{x_{i}-\alpha}{\beta} e^{-\frac{z_{i}-\alpha}{\beta}}</script>

<script type="math/tex; mode=display">\frac{\partial f}{\partial \alpha}=\frac{n}{\beta}-\frac{1}{\beta} \sum_{i=0}^{n} e^{-\frac{z_{i}-\alpha}{\beta}}</script>

<p>For the Newron-Raphson approximation method, we require double derivatives, which we use to calculate the Hessian matrix.</p>

<script type="math/tex; mode=display">\frac{\partial^{2} f}{\partial \beta^{2}}=\frac{n}{\beta^{2}}-\frac{2}{\beta^{2}} \sum_{i=0}^{n}\left(x_{i}-\alpha\right)+\frac{2}{\beta^{3}} \sum_{i=0}^{n}\left(x_{i}-\alpha\right) e^{\frac{-\left(x_{i}-\alpha\right)}{\beta}}+\frac{2}{\beta^{4}} \sum_{i=0}^{n}\left(x_{i}-\alpha\right)^{2} e^{\frac{-\left(x_{j}-\alpha\right)}{\beta}}</script>

<script type="math/tex; mode=display">\frac{\partial^{2} f}{\partial \alpha^{2}}=\frac{-i}{\beta^{2}} \sum_{i=0}^{n} e^{-\frac{x_{i}-a}{\beta}}</script>

<script type="math/tex; mode=display">\frac{\partial^{2} f}{\partial \alpha \beta}=-\frac{n}{\beta^{2}}+\frac{1}{\beta^{2}} \sum_{i=0}^{n} e^{\frac{-\left(x_{i}-\alpha\right)}{\beta}}-\frac{1}{\beta^{3}} \sum_{i=0}^{n}\left(x_{i}-\alpha\right) e^{\frac{-\left(x_{i}-a\right)}{\beta}}</script>

<p>The Hessian matrix can be calculated by,</p>

<script type="math/tex; mode=display">% <![CDATA[
H=\left[\begin{array}{ll}\frac{\partial^{2} f}{\partial \alpha^{2}} & \frac{\partial^{2} f}{\partial \alpha \beta} \\ \frac{\partial^{2} f}{\partial \alpha \beta} & \frac{\partial^{2} f}{\partial \beta^{2}}\end{array}\right] %]]></script>

<p>We also need a f matrix with the equations weâ€™re solving for,</p>

<script type="math/tex; mode=display">f=\left[\begin{array}{l}\frac{\partial f}{\partial \alpha} \\ \frac{\partial f}{\partial \beta}\end{array}\right]</script>

<p>Now we can follow the following algorithm to estimate the parameters.</p>

<p><strong>Step 1 :</strong>
Weâ€™ll choose starting values for Î± and Î², Î±(0) and Î²(0) using the method of moment estimators.</p>

<p>Î² = 0.7977âˆ— standard deviation of the dataset
Î± = mean of the dataset - 0.4501 * standard deviation</p>

<p><strong>Step 2 :</strong></p>

<p>Choose a tolerance t for the change, 10^(âˆ’10) in our case. If the level of changes are less than the tolerance the iterations will break.</p>

<p><strong>Step 3 :</strong></p>

<p>Obtain inverse of the Hessian Matrix inv(H(Î±(0))(Î²(0))) and f(Î±(0))(Î²(0))</p>

<p><strong>Step 4 :</strong></p>

<p>Obtain new values of Î± and Î², Î±(new) and Î²(new), from the Newton Raphson algorithm,</p>

<script type="math/tex; mode=display">\left[\begin{array}{l}\alpha^{(n e w)} \\ \beta^{(n e w)}\end{array}\right]=\left[\begin{array}{l}\alpha^{(o l d)} \\ \beta^{(o l d)}\end{array}\right]-H^{-1}\left(\alpha^{(o l d)}, \beta^{(o l d)}\right) f\left(\alpha^{(o l d)}, \beta^{(o l d)}\right)</script>

<p><strong>Step 5 :</strong></p>

<p>Check to see if the differences between new and the old values are small enough and compare it by the set tolerance,</p>

<script type="math/tex; mode=display">% <![CDATA[
\left[\left(\alpha^{(n e w)}-\alpha^{(o l d)}\right)^{2}+\left(\beta^{(n e w)}-\beta^{(o l d)}\right)^{2}<t\right] %]]></script>

<ul>
  <li>if No, then return to Step(3), and calculate Hâˆ’1(Î±(new))(Î²(new)) and f(Î±(new))(Î²(new)) and keep iterating.</li>
  <li>if Yes, then stop.</li>
</ul>

<p>Following are the results of the above algorithm for a gumbel destibution generated using Î± = 2.3 and Î² = 4.0 ran multiple times and averaged.</p>

<p><img src="https://i.imgur.com/EjvbGg5.png" alt="" /></p>

<p><a href="https://github.com/mnk400/gumbelMLE">Link to the code.</a></p>

  </div>
  <p class="c-article__time"><time datetime="2020-05-14T00:00:00-04:00" itemprop="datePublished">Last edited on May 14, 2020</time></p><br><br>
  <!-- Previous / Next Buttons -->
  <div class="pagenav">
    
    
  </div>
  <!-- Disqus comments view -->
  
</article>

  </div>
  <footer class="c-page__footer">
  
  <p>
    <a href="mailto:mnk_400@icloud.com">Mail</a><span class="u-separate"></span>
    <a href="https://linkedin.com/in/manik-kumar">Linkedin</a><span class="u-separate"></span>
    <a href="https://github.com/mnk400">Github</a>
  </p>
</footer>

</div>

    </main>
    
  </body>
</html>
